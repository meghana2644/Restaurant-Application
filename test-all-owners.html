<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Owner Login Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .owner-card {
            background: #f8f9fa;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #007bff;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        .success {
            color: #28a745;
            font-weight: bold;
        }
        .error {
            color: #dc3545;
            font-weight: bold;
        }
        .info {
            color: #17a2b8;
        }
        #results {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçΩÔ∏è Restaurant Owner Login Test</h1>
        <p class="info">This test verifies that each restaurant has its own individual owner account.</p>

        <div class="test-section">
            <h2>Available Restaurant Owners</h2>
            <div class="owner-card">
                <strong>Pizza Palace Owner</strong><br>
                Email: pizza@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Sushi Master Owner</strong><br>
                Email: sushi@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Burger Barn Owner</strong><br>
                Email: burger@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Spice Garden Owner</strong><br>
                Email: spice@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Dosa Delight Owner</strong><br>
                Email: dosa@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Tandoori Nights Owner</strong><br>
                Email: tandoori@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Street Bites Owner</strong><br>
                Email: street@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Royal Thali Owner</strong><br>
                Email: royal@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Dragon Palace Owner</strong><br>
                Email: dragon@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Taco Fiesta Owner</strong><br>
                Email: taco@restaurant.com<br>
                Password: owner123
            </div>
            <div class="owner-card">
                <strong>Thai Spice Owner</strong><br>
                Email: thai@restaurant.com<br>
                Password: owner123
            </div>
        </div>

        <div class="test-section">
            <h2>Test Actions</h2>
            <button onclick="testRandomOwnerLogin()">Test Random Owner Login</button>
            <button onclick="testAllOwners()">Test All Owners</button>
            <button onclick="verifyOwnerRestaurantMapping()">Verify Owner-Restaurant Mapping</button>
            <button onclick="clearResults()">Clear Results</button>
        </div>

        <div id="results"></div>
    </div>

    <script>
        const BASE_URL = 'http://localhost:5000/api';
        
        const owners = [
            { name: 'Pizza Palace Owner', email: 'pizza@restaurant.com', restaurant: 'Pizza Palace' },
            { name: 'Sushi Master Owner', email: 'sushi@restaurant.com', restaurant: 'Sushi Master' },
            { name: 'Burger Barn Owner', email: 'burger@restaurant.com', restaurant: 'Burger Barn' },
            { name: 'Spice Garden Owner', email: 'spice@restaurant.com', restaurant: 'Spice Garden' },
            { name: 'Dosa Delight Owner', email: 'dosa@restaurant.com', restaurant: 'Dosa Delight' },
            { name: 'Tandoori Nights Owner', email: 'tandoori@restaurant.com', restaurant: 'Tandoori Nights' },
            { name: 'Street Bites Owner', email: 'street@restaurant.com', restaurant: 'Street Bites' },
            { name: 'Royal Thali Owner', email: 'royal@restaurant.com', restaurant: 'Royal Thali' },
            { name: 'Dragon Palace Owner', email: 'dragon@restaurant.com', restaurant: 'Dragon Palace' },
            { name: 'Taco Fiesta Owner', email: 'taco@restaurant.com', restaurant: 'Taco Fiesta' },
            { name: 'Thai Spice Owner', email: 'thai@restaurant.com', restaurant: 'Thai Spice' }
        ];

        function logResult(message, type = 'info') {
            const results = document.getElementById('results');
            const timestamp = new Date().toLocaleTimeString();
            results.innerHTML += `<div class="${type}">[${timestamp}] ${message}</div>`;
            results.scrollTop = results.scrollHeight;
        }

        async function testOwnerLogin(owner) {
            try {
                logResult(`Testing login for ${owner.name}...`);
                
                const response = await fetch(`${BASE_URL}/restaurant-owner/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        email: owner.email,
                        password: 'owner123'
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    logResult(`‚úÖ ${owner.name} login successful!`, 'success');
                    logResult(`   Token received: ${data.token ? 'Yes' : 'No'}`, 'info');
                    logResult(`   Owner ID: ${data.user?.id || 'Not provided'}`, 'info');
                    return data;
                } else {
                    const errorData = await response.json();
                    logResult(`‚ùå ${owner.name} login failed: ${errorData.message}`, 'error');
                    return null;
                }
            } catch (error) {
                logResult(`‚ùå Error testing ${owner.name}: ${error.message}`, 'error');
                return null;
            }
        }

        async function testRandomOwnerLogin() {
            const randomOwner = owners[Math.floor(Math.random() * owners.length)];
            logResult(`üé≤ Testing random owner: ${randomOwner.name}`, 'info');
            await testOwnerLogin(randomOwner);
        }

        async function testAllOwners() {
            logResult('üîÑ Testing all restaurant owners...', 'info');
            let successCount = 0;
            
            for (const owner of owners) {
                const result = await testOwnerLogin(owner);
                if (result) successCount++;
                await new Promise(resolve => setTimeout(resolve, 500)); // Small delay
            }
            
            logResult(`üìä Summary: ${successCount}/${owners.length} owners logged in successfully`, 
                     successCount === owners.length ? 'success' : 'error');
        }

        async function verifyOwnerRestaurantMapping() {
            logResult('üîç Verifying owner-restaurant mapping...', 'info');
            
            try {
                const response = await fetch(`${BASE_URL}/restaurants`);
                if (response.ok) {
                    const restaurants = await response.json();
                    logResult(`üìã Found ${restaurants.length} restaurants`, 'info');
                    
                    restaurants.forEach(restaurant => {
                        logResult(`üè™ ${restaurant.name} (ID: ${restaurant._id})`, 'info');
                    });
                } else {
                    logResult('‚ùå Failed to fetch restaurants', 'error');
                }
            } catch (error) {
                logResult(`‚ùå Error fetching restaurants: ${error.message}`, 'error');
            }
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        // Initial message
        logResult('üöÄ Restaurant Owner Test Interface Ready', 'success');
        logResult('Server should be running on http://localhost:5000', 'info');
    </script>
</body>
</html>
